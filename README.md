
# üõ† WarcraftGame

**WarcraftGame** ‚Äî —É—á–µ–±–Ω—ã–π –ø—Ä–æ—Ç–æ—Ç–∏–ø –º–Ω–æ–≥–æ–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–π RTS –≤ –¥—É—Ö–µ —Å—Ç–∞—Ä—ã—Ö *Warcraft* –∏–ª–∏ *Age of Empires*, —Å–¥–µ–ª–∞–Ω–Ω—ã–π –Ω–∞ —Å—Ç–µ–∫–µ **.NET + WebSocket + JS**.
–ü—Ä–æ–µ–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç, –∫–∞–∫ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∫–ª–∏–µ–Ω—Ç-—Å–µ—Ä–≤–µ—Ä–Ω—É—é —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é, –∏–≥—Ä–æ–≤–æ–π —Ü–∏–∫–ª –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.


## üöÄ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –°–µ—Ä–≤–µ—Ä (C# / ASP.NET Core)

–ù–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –ø–∞–ø–∫–µ `GameServer`.
–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –∫–∞–∫ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ ASP.NET-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π WebSocket-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π.

–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:

* **WebSocketAcceptor** ‚Äî –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∏ —Å–æ–∑–¥–∞—ë—Ç `WebSocketSession` –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞.
* **WebSocketSession** ‚Äî —É–ø—Ä–∞–≤–ª—è–µ—Ç –æ–±—â–µ–Ω–∏–µ–º —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º –∏–≥—Ä–æ–∫–æ–º, –ø–æ–ª—É—á–∞–µ—Ç/–æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç JSON-—Å–æ–æ–±—â–µ–Ω–∏—è.
* **SystemTextJsonSerializer** ‚Äî —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è/–¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π.
* **PlayerRegistry** ‚Äî –ø–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –ø–æ–¥–∫–ª—é—á—ë–Ω–Ω—ã—Ö –∏–≥—Ä–æ–∫–æ–≤.
* **SnapshotService** ‚Äî —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –ø–µ—Ä–≤–∏—á–Ω—ã–π —Å–Ω–∞–ø—à–æ—Ç –º–∏—Ä–∞ (–∏–≥—Ä–æ–∫–∏, —Å—É—â–Ω–æ—Å—Ç–∏) –ø–æ—Å–ª–µ `join`.
* **IdGen** ‚Äî –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä —á–∏—Å–ª–æ–≤—ã—Ö ID.
* **–ü—Ä–æ—Ç–æ–∫–æ–ª —Å–æ–æ–±—â–µ–Ω–∏–π** (–≤ `Messages.cs`) ‚Äî —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ DTO: `PingMsg`, `PongMsg`, `JoinMsg`, `SnapshotMsg` –∏ —Ç.–¥.

–õ–æ–≥–∏–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ –º–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω–∞: –ø—Ä–∏–Ω–∏–º–∞–µ—Ç `join`, —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç –∏–≥—Ä–æ–∫–∞, –æ—Ç—Å—ã–ª–∞–µ—Ç —Å–Ω–∞–ø—à–æ—Ç, –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ `ping`.

### –ö–ª–∏–µ–Ω—Ç (JavaScript)

–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω –≤ –∫–æ—Ä–Ω–µ (`index.html`, `client.js`, `/core`, `/data`, `/render`, `/ui`).

–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:

* **Network** ‚Äî —É–ø—Ä–∞–≤–ª—è–µ—Ç WebSocket-—Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ–º, –ø–∏–Ω–≥–æ–º, –æ—Ç–ø—Ä–∞–≤–∫–æ–π –∫–æ–º–∞–Ω–¥ –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ–º —Å–Ω–∞–ø—à–æ—Ç–æ–≤.
* **World** ‚Äî —Ö—Ä–∞–Ω–∏—Ç —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –º–∏—Ä–∞ (–∏–≥—Ä–æ–∫–∏, —Å—É—â–Ω–æ—Å—Ç–∏).
* **Entity** ‚Äî –±–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å –∏–≥—Ä–æ–≤–æ–≥–æ —é–Ω–∏—Ç–∞ —Å –ø–æ–∑–∏—Ü–∏–µ–π, —Å–∫–æ—Ä–æ—Å—Ç—å—é –∏ HP.
* **Render** ‚Äî –¥–≤—É—Ö—Å–ª–æ–π–Ω—ã–π Canvas-—Ä–µ–Ω–¥–µ—Ä–µ—Ä —Å –∑—É–º–æ–º, –ø–∞–Ω–æ—Ä–∞–º–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∏ FPS-–æ—Ç—á—ë—Ç–æ–º.
* **UI** ‚Äî HUD, –ª–æ–≥ —Å–æ–±—ã—Ç–∏–π, –æ–∫–Ω–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è.
* **Model** ‚Äî –ª–æ–∫–∞–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å —Å–∏–º—É–ª—è—Ü–∏–∏: –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∫–æ–º–∞–Ω–¥—ã (spawn, move, kill –∏ —Ç.–¥.), –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Ç–∏–∫–∏, –¥–≤–∏–≥–∞–µ—Ç —é–Ω–∏—Ç–æ–≤, –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–æ–±—ã—Ç–∏—è.
* **Client bootstrap** (`client.js`) ‚Äî —Å–≤—è–∑—ã–≤–∞–µ—Ç –≤—Å–µ —á–∞—Å—Ç–∏ –≤–æ–µ–¥–∏–Ω–æ.


## ‚öôÔ∏è –ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã

1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç `index.html`.
   –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –æ–∫–Ω–æ –≤—Ö–æ–¥–∞ —Å –≤—ã–±–æ—Ä–æ–º –∏–º–µ–Ω–∏ –∏ —Ü–≤–µ—Ç–∞.
2. –ü–æ—Å–ª–µ –Ω–∞–∂–∞—Ç–∏—è *¬´–í –∏–≥—Ä—É¬ª* –∫–ª–∏–µ–Ω—Ç:

   * –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É —á–µ—Ä–µ–∑ `WebSocket`;
   * –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç `{ type: "join", name, color }`;
   * –ø–æ–ª—É—á–∞–µ—Ç `snapshot` —Å —Ç–µ–∫—É—â–∏–º–∏ –∏–≥—Ä–æ–∫–∞–º–∏.
3. –°–µ—Ä–≤–µ—Ä —Ö—Ä–∞–Ω–∏—Ç –∏–≥—Ä–æ–∫–æ–≤ –∏ –æ—Ç–≤–µ—á–∞–µ—Ç `pong` –Ω–∞ –ø–∏–Ω–≥–∏.
4. –ö–ª–∏–µ–Ω—Ç—Å–∫–∏–π —Ä–µ–Ω–¥–µ—Ä –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ —Å —Ä–∞—Å—á—ë—Ç–æ–º FPS –∏ –∫–∞–º–µ—Ä–æ–π.
5. –õ–æ–∫–∞–ª—å–Ω–∞—è `Model` –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Å–∏–º—É–ª—è—Ü–∏—é –º–∏—Ä–∞ —Å —Ç–∏–∫—Ä–µ–π—Ç–æ–º (TPS) –∏ —Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏–µ–º –¥–≤–∏–∂–µ–Ω–∏–π.

## üß© –ü—Ä–∏–º–µ—Ä JSON-–ø—Ä–æ—Ç–æ–∫–æ–ª–∞

```json
// –ö–ª–∏–µ–Ω—Ç ‚Üí –°–µ—Ä–≤–µ—Ä
{ "type": "join", "name": "Player1", "color": "red" }

// –°–µ—Ä–≤–µ—Ä ‚Üí –ö–ª–∏–µ–Ω—Ç
{
  "type": "snapshot",
  "time": 1760300066123,
  "myId": 1,
  "players": {
    "1": { "id": 1, "name": "Player1", "color": "red", "gold": 0, "wood": 0 }
  },
  "entities": {}
}

// Ping/Pong
{ "type": "ping", "clientTime": 1760300067000 }
{ "type": "pong", "serverTime": 1760300067020, "clientTime": 1760300067000 }
```

## üß† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

* **–ö–ª–∏–µ–Ω—Ç:** —á–∏—Å—Ç—ã–π ES-–º–æ–¥—É–ª—å–Ω—ã–π JavaScript, Canvas API, –ª–æ–∫–∞–ª—å–Ω–∞—è —Å–∏–º—É–ª—è—Ü–∏—è.
* **–°–µ—Ä–≤–µ—Ä:** .NET 8 (ASP.NET Core WebSockets), System.Text.Json.
* **–û–±–º–µ–Ω:** WebSocket + JSON –ø—Ä–æ—Ç–æ–∫–æ–ª.
* **–°—Ç–∏–ª—å:** –ø—Ä–æ—Å—Ç–∞—è HTML/CSS –≤–µ—Ä—Å—Ç–∫–∞ –±–µ–∑ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–æ–≤.


## üß≠ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
GameServer/
 ‚îú‚îÄ‚îÄ Application/
 ‚îÇ    ‚îú‚îÄ‚îÄ ISender.cs
 ‚îÇ    ‚îú‚îÄ‚îÄ SnapshotService.cs
 ‚îú‚îÄ‚îÄ Domain/
 ‚îÇ    ‚îú‚îÄ‚îÄ Player.cs
 ‚îÇ    ‚îú‚îÄ‚îÄ PlayerRegistry.cs
 ‚îÇ    ‚îú‚îÄ‚îÄ IdGen.cs
 ‚îú‚îÄ‚îÄ Infra/
 ‚îÇ    ‚îú‚îÄ‚îÄ WebSocketAcceptor.cs
 ‚îÇ    ‚îú‚îÄ‚îÄ WebSocketSession.cs
 ‚îÇ    ‚îú‚îÄ‚îÄ SystemTextJsonSerializer.cs
 ‚îú‚îÄ‚îÄ Protocol/
 ‚îÇ    ‚îú‚îÄ‚îÄ Messages.cs
 ‚îÇ    ‚îú‚îÄ‚îÄ Json.cs
 ‚îÇ    ‚îú‚îÄ‚îÄ UnixMs.cs
 ‚îÇ    ‚îú‚îÄ‚îÄ IMessageSerializer.cs
 ‚îî‚îÄ‚îÄ Program.cs (–≤ AppHost)
client/
 ‚îú‚îÄ‚îÄ index.html
 ‚îú‚îÄ‚îÄ client.js
 ‚îú‚îÄ‚îÄ core/
 ‚îÇ    ‚îú‚îÄ‚îÄ network.js
 ‚îÇ    ‚îú‚îÄ‚îÄ model.js
 ‚îú‚îÄ‚îÄ data/
 ‚îÇ    ‚îú‚îÄ‚îÄ world.js
 ‚îÇ    ‚îú‚îÄ‚îÄ entity.js
 ‚îú‚îÄ‚îÄ render/
 ‚îÇ    ‚îú‚îÄ‚îÄ render.js
 ‚îî‚îÄ‚îÄ ui/
      ‚îî‚îÄ‚îÄ ui.js
```

---

## üåê –ò–¥–µ—è —Ä–∞–∑–≤–∏—Ç–∏—è

* –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–µ—Ä–≤–µ—Ä–Ω—É—é —Å–∏–º—É–ª—è—Ü–∏—é –º–∏—Ä–∞.
* –î–æ–±–∞–≤–∏—Ç—å authoritative-—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é (—Å–µ—Ä–≤–µ—Ä –¥–∏–∫—Ç—É–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ, –∫–ª–∏–µ–Ω—Ç –∏–Ω—Ç–µ—Ä–ø–æ–ª–∏—Ä—É–µ—Ç).
* –†–∞—Å—à–∏—Ä–∏—Ç—å –∫–æ–º–∞–Ω–¥—ã: –∞—Ç–∞–∫–∞, –¥–æ–±—ã—á–∞, —Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ.
* –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø—Ä–∏ –ø–æ—Ç–µ—Ä–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è.
* –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∫–∞—Ä—Ç –∏ —Ç–∏–ø–æ–≤ —é–Ω–∏—Ç–æ–≤.

---

## üßæ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License.
–ü—Ä–æ–µ–∫—Ç —Å–æ–∑–¥–∞—ë—Ç—Å—è –≤ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö —Ü–µ–ª—è—Ö
